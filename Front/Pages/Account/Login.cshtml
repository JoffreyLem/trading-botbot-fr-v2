@page "/login"
@using Auth0.AspNetCore.Authentication
@using Microsoft.AspNetCore.Authentication

@functions {

    public ChallengeResult OnGet(string returnUrl = "/")
    {
        if (Uri.TryCreate(returnUrl, UriKind.Absolute, out var uri) && !uri.Scheme.Equals(Uri.UriSchemeHttps, StringComparison.OrdinalIgnoreCase))
        {
            returnUrl = "https://" + uri.Host + uri.PathAndQuery;
        }
        return Challenge(new AuthenticationProperties { RedirectUri = returnUrl }, Auth0Constants.AuthenticationScheme);
    }

}